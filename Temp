# Z coordinate values
    PICK_Z  = 0.02
    PLACE_Z = 0.02

    rospy.loginfo("Waiting for block detection")

    # Wait for initial detection and save positions BEFORE any movement
    time.sleep(3)  # Give camera time to stabilize
    
    # Save initial block positions BEFORE any arm movement
    initial_green_blocks = copy.deepcopy(xw_yw_G)
    initial_yellow_blocks = copy.deepcopy(xw_yw_Y)
    
    print(f"Initial detection - Green blocks: {len(initial_green_blocks)}, Yellow blocks: {len(initial_yellow_blocks)}")
    
    # Validate and print the saved positions
    for i, pos in enumerate(initial_green_blocks):
        print(f"Green block {i+1}: ({pos[0]:.3f}, {pos[1]:.3f})")
    
    for i, pos in enumerate(initial_yellow_blocks):
        print(f"Yellow block {i+1}: ({pos[0]:.3f}, {pos[1]:.3f})")

    # Goal positions
    green_goals = [[0.25, -0.10, PLACE_Z], [0.25, -0.20, PLACE_Z]]
    yellow_goals = [[0.25, 0.10, PLACE_Z], [0.25, 0.20, PLACE_Z]]

    # Move green blocks using INITIAL saved positions
    for i, green_block in enumerate(initial_green_blocks):
        if i < len(green_goals):
            start_pos = [green_block[0], green_block[1], PICK_Z]
            print(f"MOVING GREEN {i+1}: {start_pos} -> {green_goals[i]}")
            error = move_block(pub_command, loop_rate, start_pos, green_goals[i], vel, accel)
            if error == 0:
                print(f"Successfully moved green block {i+1}")
            else:
                print(f"Error moving green block {i+1}: {error}")
            time.sleep(2.0)

    # Move yellow blocks using INITIAL saved positions
    for i, yellow_block in enumerate(initial_yellow_blocks):
        if i < len(yellow_goals):
            start_pos = [yellow_block[0], yellow_block[1], PICK_Z]
            print(f"MOVING YELLOW {i+1}: {start_pos} -> {yellow_goals[i]}")
            error = move_block(pub_command, loop_rate, start_pos, yellow_goals[i], vel, accel)
            if error == 0:
                print(f"Successfully moved yellow block {i+1}")
            else:
                print(f"Error moving yellow block {i+1}: {error}")
            time.sleep(2.0)
